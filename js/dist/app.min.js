"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),Game=function(){function a(){_classCallCheck(this,a),this.players=[1,2],this.ties=this.getScore("ties"),this.player1Score=this.getScore(this.players[0]),this.player2Score=this.getScore(this.players[1]),this.gamesPlayed=this.player1Score+this.player2Score+this.ties,this.turn=this.players[this.gamesPlayed%2],this.turns=0,this.board=[[0,0,0],[0,0,0],[0,0,0]],this.player1ScoreDiv=document.getElementById("p1-score"),this.player2ScoreDiv=document.getElementById("p2-score"),this.tiesScoreDiv=document.getElementById("ties-score"),this.boardDiv=document.getElementById("board"),this.squares=Array.prototype.slice.call(this.boardDiv.querySelectorAll(".square")),this.start()}return _createClass(a,[{key:"start",value:function(){this.setScoreboard(),this.initEvents()}},{key:"initEvents",value:function(){var a=this;this.squares.forEach(function(b){b.addEventListener("click",function(){a.checkSelection(this)})})}},{key:"checkSelection",value:function(a){var b=a;b.classList.contains("active")||(b.className+=" active player"+this.turn,this.turns++,this.board[a.dataset.row][a.dataset.col]=this.turn,this.checkForWinner(),this.turn=this.players[(this.gamesPlayed+this.turns)%2])}},{key:"setScoreboard",value:function(){this.player1ScoreDiv.innerHTML=this.player1Score,this.player2ScoreDiv.innerHTML=this.player2Score,this.tiesScoreDiv.innerHTML=this.ties}},{key:"addWin",value:function(a){this.updateScore(a,this.getScore(a)+1)}},{key:"checkForWinner",value:function(){if(!(this.turns<5)){for(var a=0;3>a;a++)if(this.board[a][0]===this.turn&&this.board[a][1]===this.turn&&this.board[a][2]===this.turn)return void this.gameOver(this.turn);for(var b=0;3>b;b++)if(this.board[0][b]===this.turn&&this.board[1][b]===this.turn&&this.board[2][b]===this.turn)return void this.gameOver(this.turn);return this.board[0][0]===this.turn&&this.board[1][1]===this.turn&&this.board[2][2]===this.turn?void this.gameOver(this.turn):this.board[2][0]===this.turn&&this.board[1][1]===this.turn&&this.board[0][2]===this.turn?void this.gameOver(this.turn):void(9===this.turns&&this.gameOver("ties"))}}},{key:"reset",value:function(){var a=this;this.setScoreboard(),this.squares.forEach(function(b){a.removeClasses(b,["active","player1","player2"])}),this.turns=0,this.board=[[0,0,0],[0,0,0],[0,0,0]]}},{key:"gameOver",value:function(a){alert("Game Over"),this.addWin(a),this.reset()}},{key:"getScore",value:function(a){var b=a;return b="player"+a,null===localStorage.getItem(b)&&localStorage.setItem(b,0),parseInt(localStorage.getItem(b),10)}},{key:"updateScore",value:function(a,b){var c=a;c="player"+a,localStorage.setItem(c,b),this.syncScores()}},{key:"syncScores",value:function(){this.player1Score=this.getScore(this.players[0]),this.player2Score=this.getScore(this.players[1]),this.ties=this.getScore("ties")}},{key:"removeClasses",value:function(a,b){for(var c=b.length;c--;)a.classList.remove(b[c])}}]),a}();